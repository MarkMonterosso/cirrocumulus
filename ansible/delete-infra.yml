#######################################################################################
#   
#   Author      :   Mark Monterosso - Mark.Monterosso@NetApp.com
#   Date        :   23 Mar 20
#   
#   Description :   The purpose of this code is to facilitate cloning of virtual
#                   machines in VM Workstation
#   
#   Dependencies:   VM Workstation 15.x or Fusion 11
#                   
#######################################################################################
#--------------------------------------------------------------------------------------
#
# Workflow:
#   + Remove all VMs 
#
#--------------------------------------------------------------------------------------
---

- hosts:                        all
  name:                         Removing Lab Infrastructure
  gather_facts:                 false

  vars_files:
    -                           [ 'vars-provision-infra.yml' ]

  tasks:
   - name:                      "Deleting Virtual Machines"
     include_role:
        name:                   delete_vm_clones
     vars:
        vm_vars:                "{{ item }}"
     loop:                      "{{ deploy_vm_hosts }}" 
     when:
        -                       deploy_vm_hosts is defined
